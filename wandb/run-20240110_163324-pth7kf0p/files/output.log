Loading dataset from: /mnt/zhang-nas/tensorflow_datasets/downloads/manual/imagenet2012
{'coslr': True,
 'criterions': {'PerformanceLoss': {'def_file': './loss/SoftmaxLoss.py',
                                    'loss_params': {},
                                    'optim_params': None,
                                    'weight': 1.0}},
 'endlr': 0.0,
 'last': False,
 'memory': {'centroids': False, 'init_centroids': False},
 'model_dir': None,
 'networks': {'classifier': {'def_file': './models/DotProductClassifier.py',
                             'optim_params': {'lr': 0.2,
                                              'momentum': 0.9,
                                              'weight_decay': 0.0005},
                             'params': {'dataset': 'ImageNet_LT',
                                        'feat_dim': 2048,
                                        'log_dir': './logs/ImageNet_LT/models/resnext50_uniform_e90',
                                        'num_classes': 1000,
                                        'stage1_weights': False}},
              'feat_model': {'def_file': './models/ResNext50Feature.py',
                             'fix': False,
                             'optim_params': {'lr': 0.2,
                                              'momentum': 0.9,
                                              'weight_decay': 0.0005},
                             'params': {'dataset': 'ImageNet_LT',
                                        'dropout': None,
                                        'log_dir': './logs/ImageNet_LT/models/resnext50_uniform_e90',
                                        'stage1_weights': False,
                                        'use_fc': False,
                                        'use_selfatt': False}}},
 'shuffle': False,
 'training_opt': {'backbone': 'resnext50',
                  'batch_size': 512,
                  'dataset': 'ImageNet_LT',
                  'display_step': 10,
                  'feature_dim': 2048,
                  'log_dir': './logs/ImageNet_LT/models/resnext50_uniform_e90',
                  'log_root': '/logs/ImageNet_LT',
                  'num_classes': 1000,
                  'num_epochs': 150,
                  'num_workers': 4,
                  'open_threshold': 0.1,
                  'sampler': None,
                  'scheduler_params': {'gamma': 0.1, 'step_size': 30},
                  'stage': 'resnext50_uniform_e90',
                  'sub_dir': 'models',
                  'synth_data': True,
                  'synth_root': '/mnt/zhang-nas/jiahuic/synth_LT_data/test'}}
Loading data from ./data/ImageNet_LT/ImageNet_LT_train.txt
Use data transformation: Compose(
    RandomResizedCrop(size=(224, 224), scale=(0.08, 1.0), ratio=(0.75, 1.3333), interpolation=bilinear, antialias=warn)
    RandomHorizontalFlip(p=0.5)
    ColorJitter(brightness=(0.6, 1.4), contrast=(0.6, 1.4), saturation=(0.6, 1.4), hue=None)
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)
Traceback (most recent call last):
  File "/mnt/zhang-nas/jiahuic/LT-classification/main.py", line 136, in <module>
    data = {x: dataloader.load_data(data_root=data_root[dataset.rstrip('_LT')],
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/zhang-nas/jiahuic/LT-classification/main.py", line 136, in <dictcomp>
    data = {x: dataloader.load_data(data_root=data_root[dataset.rstrip('_LT')],
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/zhang-nas/jiahuic/LT-classification/data/dataloader.py", line 143, in load_data
    set_ = LT_Dataset(data_root, txt, phase, transform, synth_data, synth_root)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/zhang-nas/jiahuic/LT-classification/data/dataloader.py", line 93, in __init__
    self.img_path = self.img_path[indices]
                    ~~~~~~~~~~~~~^^^^^^^^^
TypeError: list indices must be integers or slices, not list